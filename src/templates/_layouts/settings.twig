{% extends "_layouts/cp" %}
{% set selectedSubnavItem = 'settings' %}
{% set showStoreSwitcher = showStoreSwitcher is not defined ? false : showStoreSwitcher %}

{% set title = "Settings"|t('commerce-sendcloud') %}

{% set navItems = {
    'settings': { title: "General Settings"|t('commerce-sendcloud') },
    'orders': { title: "Order Settings"|t('commerce-sendcloud') },
} %}

{% set docTitle = navItems[selectedItem].title~' - '~title %}

{% block toolbar %}
    {% if showStoreSwitcher and craft.commerce.stores.getAllStores().count() > 1 %}
        <div class="btn menubtn sitemenbtn store-selector">
            <select id="store-selector">
                {% for storeOption in craft.commerce.stores.getAllStores() %}
                    {# Include `store-settings` in the replace to avoid accidentally overrding another part of the URL #}
                    <option value="{{ craft.app.request.url|replace('settings/' ~ storeHandle, 'settings/' ~ storeOption.handle) }}" {% if store.id == storeOption.id %}selected{% endif %}>{{ storeOption.name }}</option>
                {% endfor %}
            </select>
        </div>
    {% endif %}
{% endblock %}
{% block sidebar %}
    <nav>
        <ul>
            {% for handle, item in navItems %}
                <li>
                    <a href="{{ url('commerce-sendcloud/settings/'~handle) }}"{% if handle == selectedItem %} class="sel"{% endif %}>{{ item.title }}</a>
                </li>
            {% endfor %}
        </ul>
    </nav>
{% endblock %}

{% js %}
$('#store-selector').on('change', function() {
    var storeUrl = $(this).val();
    window.location.href = storeUrl;
});
{% endjs %}